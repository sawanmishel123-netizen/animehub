<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AnimeHub - Latest Updates & Previews</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    :root {
        --primary: #ff4757;
        --primary-dark: #ff2e43;
        --secondary: #1e90ff;
        --dark: #0f0f1a;
        --darker: #090913;
        --light: #1a1a2e;
        --lighter: #2a2a3e;
        --text: #ffffff;
        --text-secondary: #b0b0c0;
        --accent: #6c5ce7;
        --success: #00b894;
        --warning: #fdcb6e;
    }
    
    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
    }
    
    body {
        font-family: 'Poppins', 'Segoe UI', sans-serif;
        background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 100%);
        color: var(--text);
        line-height: 1.6;
        min-height: 100vh;
        overflow-x: hidden;
    }
    
    /* Custom scrollbar */
    ::-webkit-scrollbar {
        width: 10px;
    }
    
    ::-webkit-scrollbar-track {
        background: var(--light);
    }
    
    ::-webkit-scrollbar-thumb {
        background: var(--primary);
        border-radius: 5px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
        background: var(--primary-dark);
    }
    
    /* Header */
    header {
        background: linear-gradient(90deg, var(--darker) 0%, rgba(30, 30, 46, 0.95) 100%);
        padding: 20px 5%;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        position: sticky;
        top: 0;
        z-index: 1000;
        border-bottom: 2px solid var(--primary);
    }
    
    .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        max-width: 1400px;
        margin: 0 auto;
    }
    
    .logo {
        display: flex;
        align-items: center;
        gap: 15px;
    }
    
    .logo i {
        font-size: 32px;
        color: var(--primary);
        background: rgba(255, 71, 87, 0.1);
        padding: 10px;
        border-radius: 10px;
    }
    
    .logo-text {
        font-size: 28px;
        font-weight: 800;
        background: linear-gradient(45deg, var(--primary), var(--secondary));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow: 0 2px 10px rgba(255, 71, 87, 0.3);
    }
    
    .tagline {
        color: var(--text-secondary);
        font-size: 14px;
        margin-top: -5px;
    }
    
    .header-stats {
        display: flex;
        gap: 25px;
    }
    
    .stat {
        text-align: center;
    }
    
    .stat-value {
        font-size: 22px;
        font-weight: 700;
        color: var(--primary);
    }
    
    .stat-label {
        font-size: 12px;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    
    /* Main container */
    .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 30px 5%;
    }
    
    /* Search section */
    .search-section {
        background: rgba(26, 26, 46, 0.7);
        border-radius: 16px;
        padding: 25px;
        margin-bottom: 30px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .search-container {
        display: flex;
        gap: 15px;
        margin-bottom: 20px;
    }
    
    #search {
        flex: 1;
        padding: 18px 25px;
        border-radius: 12px;
        border: 2px solid var(--lighter);
        background: rgba(42, 42, 62, 0.8);
        color: var(--text);
        font-size: 16px;
        transition: all 0.3s;
    }
    
    #search:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 4px rgba(255, 71, 87, 0.2);
    }
    
    .search-btn {
        background: linear-gradient(45deg, var(--primary), var(--primary-dark));
        color: white;
        border: none;
        padding: 0 30px;
        border-radius: 12px;
        cursor: pointer;
        font-weight: 600;
        font-size: 16px;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .search-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 7px 15px rgba(255, 71, 87, 0.4);
    }
    
    /* Filter buttons */
    .filter-tabs {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-bottom: 20px;
    }
    
    .filter-tab {
        background: var(--light);
        color: var(--text);
        border: none;
        padding: 12px 24px;
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .filter-tab:hover {
        background: var(--lighter);
        transform: translateY(-2px);
    }
    
    .filter-tab.active {
        background: linear-gradient(45deg, var(--primary), var(--accent));
        color: white;
        box-shadow: 0 5px 15px rgba(255, 71, 87, 0.3);
    }
    
    .genre-filters {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center;
    }
    
    .genre-tag {
        background: rgba(108, 92, 231, 0.1);
        color: var(--accent);
        border: 1px solid rgba(108, 92, 231, 0.3);
        padding: 8px 18px;
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.3s;
        font-size: 14px;
    }
    
    .genre-tag:hover {
        background: rgba(108, 92, 231, 0.2);
        transform: translateY(-2px);
    }
    
    .genre-tag.active {
        background: var(--accent);
        color: white;
        box-shadow: 0 4px 10px rgba(108, 92, 231, 0.3);
    }
    
    /* Status indicators */
    .status-badge {
        display: inline-block;
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .status-ongoing {
        background: rgba(0, 184, 148, 0.2);
        color: var(--success);
        border: 1px solid rgba(0, 184, 148, 0.4);
    }
    
    .status-finished {
        background: rgba(108, 92, 231, 0.2);
        color: var(--accent);
        border: 1px solid rgba(108, 92, 231, 0.4);
    }
    
    .status-upcoming {
        background: rgba(253, 203, 110, 0.2);
        color: var(--warning);
        border: 1px solid rgba(253, 203, 110, 0.4);
    }
    
    /* Anime grid */
    .anime-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 25px;
        padding: 20px 0;
    }
    
    .anime-card {
        background: var(--light);
        border-radius: 16px;
        overflow: hidden;
        cursor: pointer;
        transition: all 0.4s;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.05);
        height: 100%;
        display: flex;
        flex-direction: column;
    }
    
    .anime-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 30px rgba(255, 71, 87, 0.2);
        border-color: rgba(255, 71, 87, 0.3);
    }
    
    .card-header {
        position: relative;
        height: 200px;
        overflow: hidden;
    }
    
    .card-poster {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.5s;
    }
    
    .anime-card:hover .card-poster {
        transform: scale(1.05);
    }
    
    .card-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(to top, rgba(15, 15, 26, 0.9) 0%, transparent 50%);
        display: flex;
        align-items: flex-end;
        padding: 15px;
    }
    
    .episode-badge {
        background: var(--primary);
        color: white;
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 13px;
        font-weight: 700;
    }
    
    .video-preview-btn {
        position: absolute;
        top: 15px;
        right: 15px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        border: none;
        cursor: pointer;
        transition: all 0.3s;
        z-index: 2;
    }
    
    .video-preview-btn:hover {
        background: var(--primary);
        transform: scale(1.1);
    }
    
    .card-body {
        padding: 20px;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
    }
    
    .anime-title {
        font-size: 18px;
        font-weight: 700;
        margin-bottom: 10px;
        line-height: 1.3;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    
    .anime-info {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15px;
        font-size: 14px;
    }
    
    .anime-score {
        color: var(--warning);
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    .anime-episodes {
        color: var(--text-secondary);
    }
    
    .anime-genres {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 15px;
    }
    
    .genre {
        background: rgba(108, 92, 231, 0.1);
        color: var(--accent);
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: 600;
    }
    
    .anime-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: auto;
    }
    
    .release-date {
        font-size: 13px;
        color: var(--text-secondary);
    }
    
    .watch-btn {
        background: rgba(255, 71, 87, 0.1);
        color: var(--primary);
        border: 1px solid rgba(255, 71, 87, 0.3);
        padding: 8px 16px;
        border-radius: 8px;
        font-size: 13px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    .watch-btn:hover {
        background: var(--primary);
        color: white;
    }
    
    /* Video preview modal */
    .video-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(9, 9, 19, 0.95);
        z-index: 2000;
        justify-content: center;
        align-items: center;
        padding: 20px;
    }
    
    .video-container {
        width: 100%;
        max-width: 900px;
        background: var(--light);
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
    }
    
    .video-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        background: var(--darker);
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .video-title {
        font-size: 22px;
        font-weight: 700;
        color: var(--primary);
    }
    
    .close-video {
        background: none;
        border: none;
        color: var(--text);
        font-size: 28px;
        cursor: pointer;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s;
    }
    
    .close-video:hover {
        background: rgba(255, 71, 87, 0.1);
        color: var(--primary);
    }
    
    .video-player {
        width: 100%;
        height: 500px;
        background: #000;
    }
    
    .video-player iframe {
        width: 100%;
        height: 100%;
        border: none;
    }
    
    .video-info {
        padding: 20px;
    }
    
    /* Alternative video player for local file compatibility */
    .local-video-player {
        width: 100%;
        height: 500px;
        background: #000;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        color: white;
        padding: 20px;
        text-align: center;
    }
    
    .local-video-player video {
        max-width: 100%;
        max-height: 70%;
        border-radius: 8px;
    }
    
    .video-fallback {
        background: var(--light);
        padding: 40px;
        text-align: center;
        border-radius: 12px;
        margin: 20px;
    }
    
    /* Details modal */
    .details-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(9, 9, 19, 0.95);
        z-index: 2000;
        overflow-y: auto;
        padding: 40px 20px;
    }
    
    .details-content {
        max-width: 1000px;
        margin: 0 auto;
        background: var(--light);
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 25px 60px rgba(0, 0, 0, 0.5);
    }
    
    .details-header {
        display: flex;
        gap: 30px;
        padding: 40px;
        background: linear-gradient(90deg, var(--darker) 0%, var(--light) 100%);
        flex-wrap: wrap;
    }
    
    .details-poster {
        flex: 0 0 300px;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
    }
    
    .details-poster img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    .details-main {
        flex: 1;
        min-width: 300px;
    }
    
    .details-title {
        font-size: 32px;
        font-weight: 800;
        margin-bottom: 15px;
        background: linear-gradient(45deg, var(--primary), var(--secondary));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }
    
    .details-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-bottom: 25px;
    }
    
    .meta-item {
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--text-secondary);
        font-size: 15px;
    }
    
    .details-description {
        line-height: 1.8;
        margin-bottom: 30px;
        color: var(--text-secondary);
    }
    
    .details-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 20px;
        padding: 30px;
        background: var(--darker);
    }
    
    .detail-box {
        background: rgba(255, 255, 255, 0.05);
        padding: 20px;
        border-radius: 12px;
        border-left: 4px solid var(--primary);
    }
    
    .detail-label {
        font-size: 13px;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 8px;
    }
    
    .detail-value {
        font-size: 18px;
        font-weight: 600;
    }
    
    .notification-btn {
        position: fixed;
        bottom: 30px;
        right: 30px;
        padding: 15px 25px;
        background: linear-gradient(45deg, var(--primary), var(--primary-dark));
        color: white;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        font-weight: 700;
        box-shadow: 0 10px 25px rgba(255, 71, 87, 0.4);
        z-index: 999;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .notification-btn:hover {
        transform: translateY(-5px) scale(1.05);
        box-shadow: 0 15px 30px rgba(255, 71, 87, 0.6);
    }
    
    /* Loading animation */
    .loading {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 60px;
        grid-column: 1 / -1;
    }
    
    .spinner {
        width: 60px;
        height: 60px;
        border: 5px solid rgba(255, 71, 87, 0.2);
        border-top-color: var(--primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
        to { transform: rotate(360deg); }
    }
    
    /* Responsive */
    @media (max-width: 1024px) {
        .anime-grid {
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        }
        
        .details-header {
            flex-direction: column;
        }
        
        .details-poster {
            flex: 0 0 auto;
            max-width: 300px;
            margin: 0 auto;
        }
    }
    
    @media (max-width: 768px) {
        .header-content {
            flex-direction: column;
            gap: 20px;
        }
        
        .header-stats {
            width: 100%;
            justify-content: space-around;
        }
        
        .search-container {
            flex-direction: column;
        }
        
        .search-btn {
            justify-content: center;
            padding: 18px;
        }
        
        .anime-grid {
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
        }
        
        .video-player, .local-video-player {
            height: 300px;
        }
    }
    
    @media (max-width: 480px) {
        .anime-grid {
            grid-template-columns: 1fr;
        }
        
        .filter-tabs {
            justify-content: center;
        }
        
        .filter-tab {
            padding: 10px 15px;
            font-size: 14px;
        }
    }
</style>
</head>
<body>

<button onclick="enableNotifications()" class="notification-btn">
    <i class="fas fa-bell"></i> Enable Alerts
</button>

<header>
    <div class="header-content">
        <div class="logo">
            <i class="fas fa-tv"></i>
            <div>
                <div class="logo-text">AnimeHub</div>
                <div class="tagline">Latest episodes, previews & schedules</div>
            </div>
        </div>
        <div class="header-stats">
            <div class="stat">
                <div class="stat-value" id="totalAnime">0</div>
                <div class="stat-label">Total</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="airingCount">0</div>
                <div class="stat-label">Airing</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="newEpisodes">0</div>
                <div class="stat-label">New Today</div>
            </div>
        </div>
    </div>
</header>

<div class="container">
    <div class="search-section">
        <div class="search-container">
            <input id="search" type="text" placeholder="Search anime by title, genre, studio, or year...">
            <button class="search-btn" onclick="searchAnime()">
                <i class="fas fa-search"></i> Search
            </button>
        </div>
        
        <div class="filter-tabs">
            <button class="filter-tab active" onclick="filterAnime('trending')">
                <i class="fas fa-fire"></i> Trending
            </button>
            <button class="filter-tab" onclick="filterAnime('airing')">
                <i class="fas fa-play-circle"></i> Airing Now
            </button>
            <button class="filter-tab" onclick="filterAnime('upcoming')">
                <i class="fas fa-calendar-alt"></i> Upcoming
            </button>
            <button class="filter-tab" onclick="filterAnime('popular')">
                <i class="fas fa-star"></i> Popular
            </button>
            <button class="filter-tab" onclick="filterAnime('recent')">
                <i class="fas fa-clock"></i> Recent
            </button>
        </div>
        
        <div class="genre-filters">
            <div class="genre-tag active" onclick="toggleGenre('all')">All</div>
            <div class="genre-tag" onclick="toggleGenre('action')">Action</div>
            <div class="genre-tag" onclick="toggleGenre('fantasy')">Fantasy</div>
            <div class="genre-tag" onclick="toggleGenre('romance')">Romance</div>
            <div class="genre-tag" onclick="toggleGenre('comedy')">Comedy</div>
            <div class="genre-tag" onclick="toggleGenre('drama')">Drama</div>
            <div class="genre-tag" onclick="toggleGenre('sci-fi')">Sci-Fi</div>
            <div class="genre-tag" onclick="toggleGenre('mystery')">Mystery</div>
            <div class="genre-tag" onclick="toggleGenre('horror')">Horror</div>
        </div>
    </div>
    
    <div id="animeContainer" class="anime-grid">
        <!-- Anime cards will be inserted here -->
    </div>
</div>

<!-- Video Preview Modal -->
<div id="videoModal" class="video-modal">
    <div class="video-container">
        <div class="video-header">
            <div class="video-title" id="videoTitle">Anime Preview</div>
            <button class="close-video" onclick="closeVideo()">×</button>
        </div>
        <div id="videoPlayerContainer">
            <!-- Video will be loaded here - using alternative method -->
        </div>
        <div class="video-info" id="videoInfo">
            <!-- Video info will be loaded here -->
        </div>
    </div>
</div>

<!-- Anime Details Modal -->
<div id="detailsModal" class="details-modal">
    <div class="details-content">
        <div class="details-header">
            <div class="details-poster">
                <img id="detailImage" src="" alt="Anime Poster">
            </div>
            <div class="details-main">
                <h1 id="detailTitle">Anime Title</h1>
                <div class="details-meta">
                    <div class="meta-item">
                        <i class="fas fa-play-circle"></i>
                        <span id="detailEpisodes">0 Episodes</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-clock"></i>
                        <span id="detailDuration">0 min</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-calendar"></i>
                        <span id="detailDate">2023</span>
                    </div>
                    <div id="detailStatus" class="status-badge status-ongoing">Ongoing</div>
                </div>
                <div class="details-description" id="detailDescription">
                    Loading description...
                </div>
                <button class="watch-btn" onclick="playVideoFromDetails()">
                    <i class="fas fa-play"></i> Watch Preview
                </button>
            </div>
        </div>
        <div class="details-grid" id="detailGrid">
            <!-- Details will be populated here -->
        </div>
    </div>
</div>

<script>
// Anime data and state
let animeList = [];
let filteredAnime = [];
let currentFilter = 'trending';
let currentGenre = 'all';
let videoTrailers = {}; // Store video URLs for each anime
let currentVideoPlayer = null;

// Request notification permission on load
document.addEventListener("DOMContentLoaded", () => {
    if ("Notification" in window) {
        Notification.requestPermission();
    }
    loadAnimeData();
    
    // Set up search to trigger on Enter key
    document.getElementById('search').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            searchAnime();
        }
    });
});

// Load anime data
async function loadAnimeData() {
    // Show loading state
    document.getElementById('animeContainer').innerHTML = `
        <div class="loading">
            <div class="spinner"></div>
        </div>
    `;
    
    try {
        await fetchAnimeFromAPI();
    } catch (error) {
        console.error("Error fetching anime:", error);
        loadSampleData();
    }
}

// Fetch from AniList API
async function fetchAnimeFromAPI() {
    const query = `
        query {
            Page(perPage: 50) {
                media(type: ANIME, sort: TRENDING_DESC) {
                    id
                    title { romaji english }
                    description
                    coverImage { large extraLarge }
                    episodes
                    duration
                    status
                    startDate { year month day }
                    endDate { year month day }
                    nextAiringEpisode {
                        episode
                        timeUntilAiring
                    }
                    genres
                    averageScore
                    popularity
                    studios(isMain: true) {
                        nodes { name }
                    }
                    trailer { id site }
                }
            }
        }
    `;

    const response = await fetch("https://graphql.anilist.co", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ query })
    });

    const data = await response.json();
    const media = data.data.Page.media;
    
    // Process and enhance anime data
    animeList = media.map(anime => {
        // Fix status display
        let status = "FINISHED";
        if (anime.status === "RELEASING") {
            status = "ONGOING";
        } else if (anime.status === "NOT_YET_RELEASED") {
            status = "UPCOMING";
        } else {
            status = "FINISHED";
        }
        
        // Generate realistic release dates
        const today = new Date();
        let releaseDate;
        
        if (anime.startDate && anime.startDate.year) {
            const month = anime.startDate.month || 1;
            const day = anime.startDate.day || 1;
            releaseDate = new Date(anime.startDate.year, month - 1, day);
        } else {
            // Generate random date for demo
            const daysOffset = Math.floor(Math.random() * 180) - 90; // ±90 days from today
            releaseDate = new Date(today);
            releaseDate.setDate(today.getDate() + daysOffset);
        }
        
        // Format date for display
        const formattedDate = releaseDate.toLocaleDateString('en-US', {
            month: 'short',
            day: 'numeric',
            year: 'numeric'
        });
        
        // Duration with fallback
        const duration = anime.duration ? `${anime.duration} min/ep` : "24 min/ep";
        
        // Store trailer info if available
        if (anime.trailer && anime.trailer.id) {
            const videoId = anime.trailer.id;
            videoTrailers[anime.id] = videoId;
        }
        
        // Check if there's a new episode (for demo purposes)
        const hasNewEpisode = Math.random() > 0.5 && status === "ONGOING";
        
        return {
            ...anime,
            formattedDate,
            duration,
            status,
            hasNewEpisode,
            releaseTimestamp: releaseDate.getTime()
        };
    });
    
    filteredAnime = [...animeList];
    displayAnime(filteredAnime);
    updateStats();
}

// Sample data for fallback
function loadSampleData() {
    const sampleAnime = [
        {
            id: 1,
            title: { romaji: "Attack on Titan: The Final Season", english: "Attack on Titan: The Final Season" },
            description: "The final battle for humanity's survival against the Titans. Eren Yeager and his friends face their ultimate challenge.",
            coverImage: { large: "https://s4.anilist.co/file/anilistcdn/media/anime/cover/medium/bx16498-6H3WqYMKTMzC.jpg", extraLarge: "https://s4.anilist.co/file/anilistcdn/media/anime/cover/large/bx16498-6H3WqYMKTMzC.jpg" },
            episodes: 28,
            duration: 24,
            status: "FINISHED",
            startDate: { year: 2020, month: 12, day: 7 },
            genres: ["Action", "Drama", "Fantasy", "Mystery"],
            averageScore: 88,
            popularity: 1000000,
            studios: { nodes: [{ name: "MAPPA" }] },
            formattedDate: "Dec 7, 2020",
            hasNewEpisode: false,
            releaseTimestamp: new Date(2020, 11, 7).getTime()
        },
        {
            id: 2,
            title: { romaji: "Jujutsu Kaisen Season 2", english: "Jujutsu Kaisen Season 2" },
            description: "Yuji Itadori continues his journey as a Jujutsu Sorcerer, facing powerful curses and uncovering dark secrets.",
            coverImage: { large: "https://s4.anilist.co/file/anilistcdn/media/anime/cover/medium/bx145064-7hSSvq5blG1N.jpg", extraLarge: "https://s4.anilist.co/file/anilistcdn/media/anime/cover/large/bx145064-7hSSvq5blG1N.jpg" },
            episodes: 23,
            duration: 24,
            status: "ONGOING",
            startDate: { year: 2023, month: 7, day: 6 },
            genres: ["Action", "Fantasy", "Supernatural"],
            averageScore: 86,
            popularity: 950000,
            studios: { nodes: [{ name: "MAPPA" }] },
            formattedDate: "Jul 6, 2023",
            hasNewEpisode: true,
            releaseTimestamp: new Date(2023, 6, 6).getTime()
        },
        {
            id: 3,
            title: { romaji: "Frieren: Beyond Journey's End", english: "Frieren: Beyond Journey's End" },
            description: "An elf mage reflects on her past journey after her companions have passed away, exploring themes of time and legacy.",
            coverImage: { large: "https://s4.anilist.co/file/anilistcdn/media/anime/cover/medium/bx154587-bEhOFHQkOehq.jpg", extraLarge: "https://s4.anilist.co/file/anilistcdn/media/anime/cover/large/bx154587-bEhOFHQkOehq.jpg" },
            episodes: 28,
            duration: 24,
            status: "ONGOING",
            startDate: { year: 2023, month: 9, day: 29 },
            genres: ["Fantasy", "Drama", "Adventure"],
            averageScore: 91,
            popularity: 850000,
            studios: { nodes: [{ name: "Madhouse" }] },
            formattedDate: "Sep 29, 2023",
            hasNewEpisode: true,
            releaseTimestamp: new Date(2023, 8, 29).getTime()
        },
        {
            id: 4,
            title: { romaji: "Solo Leveling", english: "Solo Leveling" },
            description: "In a world where hunters battle monsters, the weakest hunter Sung Jin-Woo gets a second chance at life with a mysterious system.",
            coverImage: { large: "https://s4.anilist.co/file/anilistcdn/media/anime/cover/medium/bx156251-kW9Jemmp8g8U.jpg", extraLarge: "https://s4.anilist.co/file/anilistcdn/media/anime/cover/large/bx156251-kW9Jemmp8g8U.jpg" },
            episodes: 12,
            duration: 24,
            status: "ONGOING",
            startDate: { year: 2024, month: 1, day: 7 },
            genres: ["Action", "Adventure", "Fantasy"],
            averageScore: 84,
            popularity: 920000,
            studios: { nodes: [{ name: "A-1 Pictures" }] },
            formattedDate: "Jan 7, 2024",
            hasNewEpisode: true,
            releaseTimestamp: new Date(2024, 0, 7).getTime()
        },
        {
            id: 5,
            title: { romaji: "Demon Slayer: Kimetsu no Yaiba", english: "Demon Slayer: Kimetsu no Yaiba" },
            description: "Tanjiro Kamado becomes a demon slayer after his family is slaughtered and his sister turned into a demon.",
            coverImage: { large: "https://s4.anilist.co/file/anilistcdn/media/anime/cover/medium/bx101922-PEn1CTc93bxC.jpg", extraLarge: "https://s4.anilist.co/file/anilistcdn/media/anime/cover/large/bx101922-PEn1CTc93bxC.jpg" },
            episodes: 55,
            duration: 24,
            status: "ONGOING",
            startDate: { year: 2019, month: 4, day: 6 },
            genres: ["Action", "Fantasy", "Supernatural"],
            averageScore: 85,
            popularity: 980000,
            studios: { nodes: [{ name: "ufotable" }] },
            formattedDate: "Apr 6, 2019",
            hasNewEpisode: false,
            releaseTimestamp: new Date(2019, 3, 6).getTime()
        }
    ];
    
    // Add more sample anime
    const moreTitles = [
        { title: "Chainsaw Man", status: "FINISHED", genres: ["Action", "Fantasy", "Horror"] },
        { title: "Spy × Family", status: "ONGOING", genres: ["Action", "Comedy", "Slice of Life"] },
        { title: "Oshi no Ko", status: "FINISHED", genres: ["Drama", "Supernatural", "Suspense"] },
        { title: "Bocchi the Rock!", status: "FINISHED", genres: ["Comedy", "Music"] },
        { title: "Vinland Saga Season 2", status: "FINISHED", genres: ["Action", "Adventure", "Drama"] },
        { title: "Mushoku Tensei: Jobless Reincarnation", status: "ONGOING", genres: ["Drama", "Fantasy", "Ecchi"] },
        { title: "Zom 100: Bucket List of the Dead", status: "ONGOING", genres: ["Action", "Comedy", "Horror"] },
        { title: "Heavenly Delusion", status: "FINISHED", genres: ["Sci-Fi", "Mystery", "Suspense"] },
        { title: "Hell's Paradise", status: "FINISHED", genres: ["Action", "Fantasy", "Historical"] },
        { title: "Blue Lock", status: "FINISHED", genres: ["Sports", "Action"] }
    ];
    
    moreTitles.forEach((item, i) => {
        const today = new Date();
        const daysOffset = Math.floor(Math.random() * 180) - 90;
        const releaseDate = new Date(today);
        releaseDate.setDate(today.getDate() + daysOffset);
        
        sampleAnime.push({
            id: 6 + i,
            title: { romaji: item.title, english: item.title },
            description: `This is a sample description for ${item.title}. It has an interesting plot with ${item.genres.join(", ")} elements.`,
            coverImage: { large: `https://picsum.photos/300/400?random=${i+6}`, extraLarge: `https://picsum.photos/600/800?random=${i+6}` },
            episodes: 12 + Math.floor(Math.random() * 24),
            duration: 20 + Math.floor(Math.random() * 10),
            status: item.status === "ONGOING" ? "RELEASING" : "FINISHED",
            startDate: { year: 2020 + Math.floor(Math.random() * 4), month: 1 + Math.floor(Math.random() * 12), day: 1 + Math.floor(Math.random() * 28) },
            genres: item.genres,
            averageScore: 70 + Math.floor(Math.random() * 30),
            popularity: Math.floor(Math.random() * 1000000),
            studios: { nodes: [{ name: "Studio " + String.fromCharCode(65 + Math.floor(Math.random() * 26)) }] },
            formattedDate: releaseDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }),
            hasNewEpisode: Math.random() > 0.6 && item.status === "ONGOING",
            releaseTimestamp: releaseDate.getTime()
        });
    });
    
    // Add video trailers for sample data - using video IDs only
    const sampleTrailers = [
        "Bz8yOJ-XPwE", // Demon Slayer
        "pManC2K2T-s", // Jujutsu Kaisen
        "WH_IoN5LjqM", // Attack on Titan
        "M4I8Q9hUTrU", // My Hero Academia
        "wJelEXaPhJ8", // One Piece
        "dFlDRhvM4L0", // Chainsaw Man
        "41rGtWEXa3k", // Spy x Family
        "Zy3w9M3TvX8"  // Oshi no Ko
    ];
    
    sampleAnime.forEach((anime, i) => {
        const videoId = sampleTrailers[i % sampleTrailers.length];
        videoTrailers[anime.id] = videoId;
    });
    
    animeList = sampleAnime.map(anime => {
        // Fix status for display
        let status = "FINISHED";
        if (anime.status === "RELEASING") {
            status = "ONGOING";
        } else if (anime.status === "NOT_YET_RELEASED") {
            status = "UPCOMING";
        } else {
            status = "FINISHED";
        }
        
        return {
            ...anime,
            status,
            duration: anime.duration ? `${anime.duration} min/ep` : "24 min/ep"
        };
    });
    
    filteredAnime = [...animeList];
    displayAnime(filteredAnime);
    updateStats();
}

// Display anime cards
function displayAnime(list) {
    const container = document.getElementById("animeContainer");
    
    if (list.length === 0) {
        container.innerHTML = `
            <div style="grid-column:1/-1; text-align:center; padding:60px; color:#aaa;">
                <i class="fas fa-search" style="font-size:48px; margin-bottom:20px; opacity:0.5;"></i>
                <h3>No anime found</h3>
                <p>Try adjusting your search or filters</p>
            </div>
        `;
        return;
    }
    
    container.innerHTML = "";
    
    list.forEach(anime => {
        const card = document.createElement("div");
        card.className = "anime-card";
        
        // Determine status badge
        let statusBadge = "";
        if (anime.status === "ONGOING") {
            statusBadge = `<div class="status-badge status-ongoing">Ongoing</div>`;
        } else if (anime.status === "UPCOMING") {
            statusBadge = `<div class="status-badge status-upcoming">Upcoming</div>`;
        } else {
            statusBadge = `<div class="status-badge status-finished">Finished</div>`;
        }
        
        // Episode info
        let episodeInfo = "";
        if (anime.hasNewEpisode) {
            episodeInfo = `<div class="episode-badge">New Episode!</div>`;
        } else if (anime.nextAiringEpisode) {
            episodeInfo = `<div class="episode-badge">Ep ${anime.nextAiringEpisode.episode} Soon</div>`;
        }
        
        // Limit genres display
        const displayedGenres = anime.genres.slice(0, 3);
        
        card.innerHTML = `
            <div class="card-header">
                <img class="card-poster" src="${anime.coverImage.large}" alt="${anime.title.romaji}">
                <div class="card-overlay">
                    ${episodeInfo}
                </div>
                <button class="video-preview-btn" onclick="playVideo(${anime.id}, event)">
                    <i class="fas fa-play"></i>
                </button>
            </div>
            <div class="card-body">
                <h3 class="anime-title">${anime.title.romaji}</h3>
                <div class="anime-info">
                    <div class="anime-score">
                        <i class="fas fa-star"></i> ${anime.averageScore || "N/A"}
                    </div>
                    <div class="anime-episodes">
                        ${anime.episodes || "?"} Episodes
                    </div>
                </div>
                <div class="anime-genres">
                    ${displayedGenres.map(genre => `<span class="genre">${genre}</span>`).join('')}
                </div>
                <div class="anime-footer">
                    <div class="release-date">${anime.formattedDate}</div>
                    ${statusBadge}
                </div>
            </div>
        `;
        
        // Add click event for card (opens details)
        card.onclick = (e) => {
            // Don't trigger if clicking the video button
            if (!e.target.closest('.video-preview-btn')) {
                showAnimeDetails(anime);
            }
        };
        
        container.appendChild(card);
    });
    
    // Update total anime count
    document.getElementById('totalAnime').textContent = list.length;
}

// Search functionality
function searchAnime() {
    const text = document.getElementById("search").value.toLowerCase().trim();
    
    if (!text) {
        // If search is empty, show filtered list
        applyFilters();
        return;
    }
    
    const filtered = animeList.filter(anime => {
        // Search in title
        const titleMatch = anime.title.romaji.toLowerCase().includes(text) || 
                          (anime.title.english && anime.title.english.toLowerCase().includes(text));
        
        // Search in genres
        const genreMatch = anime.genres && anime.genres.some(genre => 
            genre.toLowerCase().includes(text)
        );
        
        // Search in description
        const descMatch = anime.description && anime.description.toLowerCase().includes(text);
        
        // Search in studio
        const studioMatch = anime.studios && anime.studios.nodes && 
                           anime.studios.nodes.some(studio => studio.name.toLowerCase().includes(text));
        
        // Search in year
        const yearMatch = anime.startDate && anime.startDate.year.toString().includes(text);
        
        return titleMatch || genreMatch || descMatch || studioMatch || yearMatch;
    });
    
    filteredAnime = filtered;
    displayAnime(filteredAnime);
}

// Filter anime by category
function filterAnime(category) {
    currentFilter = category;
    
    // Update active button
    document.querySelectorAll('.filter-tab').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // Apply filters
    applyFilters();
}

// Toggle genre filter
function toggleGenre(genre) {
    currentGenre = genre;
    
    // Update active filter
    document.querySelectorAll('.genre-tag').forEach(tag => {
        tag.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // Apply filters
    applyFilters();
}

// Apply both category and genre filters
function applyFilters() {
    let filtered = [...animeList];
    
    // Apply category filter
    if (currentFilter === 'airing') {
        filtered = filtered.filter(anime => anime.status === "ONGOING");
    } else if (currentFilter === 'upcoming') {
        filtered = filtered.filter(anime => anime.status === "UPCOMING");
    } else if (currentFilter === 'popular') {
        filtered = filtered.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));
    } else if (currentFilter === 'recent') {
        filtered = filtered.filter(anime => anime.hasNewEpisode);
    } else {
        // Trending is default
        filtered = filtered.sort((a, b) => (b.averageScore || 0) - (a.averageScore || 0));
    }
    
    // Apply genre filter
    if (currentGenre !== 'all') {
        filtered = filtered.filter(anime => 
            anime.genres && anime.genres.some(g => g.toLowerCase().replace(/\s+/g, '-') === currentGenre)
        );
    }
    
    filteredAnime = filtered;
    displayAnime(filteredAnime);
}

// Show anime details
function showAnimeDetails(anime) {
    const modal = document.getElementById('detailsModal');
    const title = document.getElementById('detailTitle');
    const image = document.getElementById('detailImage');
    const episodes = document.getElementById('detailEpisodes');
    const duration = document.getElementById('detailDuration');
    const date = document.getElementById('detailDate');
    const status = document.getElementById('detailStatus');
    const description = document.getElementById('detailDescription');
    const grid = document.getElementById('detailGrid');
    
    // Set basic info
    title.textContent = anime.title.romaji || anime.title.english;
    image.src = anime.coverImage.extraLarge || anime.coverImage.large;
    image.alt = anime.title.romaji;
    
    episodes.textContent = `${anime.episodes || "?"} Episodes`;
    duration.textContent = anime.duration || "24 min/ep";
    date.textContent = anime.formattedDate;
    
    // Set status with correct class
    status.textContent = anime.status;
    status.className = "status-badge ";
    if (anime.status === "ONGOING") {
        status.classList.add("status-ongoing");
    } else if (anime.status === "UPCOMING") {
        status.classList.add("status-upcoming");
    } else {
        status.classList.add("status-finished");
    }
    
    // Clean description
    let cleanDescription = anime.description || "No description available.";
    cleanDescription = cleanDescription.replace(/<[^>]*>/g, '');
    description.textContent = cleanDescription.length > 300 ? 
        cleanDescription.substring(0, 300) + "..." : cleanDescription;
    
    // Create details grid
    const startDate = anime.startDate ? 
        `${anime.startDate.year || '?'}-${anime.startDate.month || '?'}-${anime.startDate.day || '?'}` : 
        'Unknown';
    
    const endDate = anime.endDate ? 
        `${anime.endDate.year || '?'}-${anime.endDate.month || '?'}-${anime.endDate.day || '?'}` : 
        anime.status === "FINISHED" ? startDate : 'Ongoing';
    
    const studios = anime.studios && anime.studios.nodes && anime.studios.nodes.length > 0 ? 
        anime.studios.nodes.map(s => s.name).join(', ') : 
        'Unknown';
    
    grid.innerHTML = `
        <div class="detail-box">
            <div class="detail-label">Score</div>
            <div class="detail-value">${anime.averageScore || 'N/A'}/100</div>
        </div>
        <div class="detail-box">
            <div class="detail-label">Popularity</div>
            <div class="detail-value">#${anime.popularity ? Math.floor(anime.popularity / 1000) + 'K' : 'N/A'}</div>
        </div>
        <div class="detail-box">
            <div class="detail-label">Start Date</div>
            <div class="detail-value">${startDate}</div>
        </div>
        <div class="detail-box">
            <div class="detail-label">${anime.status === "FINISHED" ? "End Date" : "Latest"}</div>
            <div class="detail-value">${endDate}</div>
        </div>
        <div class="detail-box">
            <div class="detail-label">Studios</div>
            <div class="detail-value">${studios}</div>
        </div>
        <div class="detail-box">
            <div class="detail-label">Genres</div>
            <div class="detail-value">${anime.genres ? anime.genres.join(', ') : 'Unknown'}</div>
        </div>
    `;
    
    // Store current anime for video playback
    modal.dataset.currentAnimeId = anime.id;
    
    // Show modal
    modal.style.display = 'block';
    document.body.style.overflow = 'hidden';
}

// Play video from details modal
function playVideoFromDetails() {
    const modal = document.getElementById('detailsModal');
    const animeId = modal.dataset.currentAnimeId;
    
    if (animeId) {
        closeDetails();
        setTimeout(() => playVideo(parseInt(animeId)), 300);
    }
}

// Play video preview - FIXED VERSION that works locally
function playVideo(animeId, event) {
    if (event) {
        event.stopPropagation(); // Prevent card click
    }
    
    const anime = animeList.find(a => a.id === animeId);
    if (!anime) return;
    
    const modal = document.getElementById('videoModal');
    const videoPlayerContainer = document.getElementById('videoPlayerContainer');
    const videoTitle = document.getElementById('videoTitle');
    const videoInfo = document.getElementById('videoInfo');
    
    // Set video title
    videoTitle.textContent = `${anime.title.romaji} - Preview`;
    
    // Clear previous video
    if (currentVideoPlayer) {
        currentVideoPlayer.remove();
        currentVideoPlayer = null;
    }
    
    const videoId = videoTrailers[animeId];
    
    // Try to detect if we're running locally (file:// protocol)
    const isLocalFile = window.location.protocol === 'file:';
    
    if (isLocalFile) {
        // For local files, use a fallback approach with click-to-play
        videoPlayerContainer.innerHTML = `
            <div class="local-video-player">
                <div style="margin-bottom: 20px;">
                    <i class="fas fa-play-circle" style="font-size: 60px; color: var(--primary); margin-bottom: 15px;"></i>
                    <h3 style="margin-bottom: 10px;">Preview Available</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 20px; max-width: 500px;">
                        Click the button below to watch the trailer for ${anime.title.romaji} on YouTube
                    </p>
                    <button onclick="window.open('https://www.youtube.com/watch?v=${videoId}', '_blank')" 
                            style="background: var(--primary); color: white; border: none; padding: 12px 30px; 
                                   border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 16px;
                                   display: flex; align-items: center; gap: 10px; margin: 0 auto;">
                        <i class="fab fa-youtube"></i> Watch Trailer on YouTube
                    </button>
                </div>
                <p style="color: var(--text-secondary); font-size: 14px; margin-top: 20px; max-width: 600px;">
                    Note: For security reasons, YouTube doesn't allow embedded videos to play directly from local files. 
                    The trailer will open in a new tab for the best viewing experience.
                </p>
            </div>
        `;
    } else if (videoId) {
        // For hosted websites, use embedded player
        // Use a proxy approach to avoid X-Frame restrictions
        videoPlayerContainer.innerHTML = `
            <div class="video-player">
                <iframe 
                    src="https://www.youtube-nocookie.com/embed/${videoId}?rel=0&modestbranding=1&playsinline=1" 
                    frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                    allowfullscreen
                    referrerpolicy="strict-origin-when-cross-origin">
                </iframe>
            </div>
        `;
    } else {
        videoPlayerContainer.innerHTML = `
            <div class="local-video-player">
                <div style="text-align: center;">
                    <i class="fas fa-video-slash" style="font-size: 60px; color: var(--text-secondary); margin-bottom: 20px;"></i>
                    <h3>No Trailer Available</h3>
                    <p style="color: var(--text-secondary); margin-top: 10px;">
                        Sorry, there's no preview available for ${anime.title.romaji} at the moment.
                    </p>
                </div>
            </div>
        `;
    }
    
    // Set video info
    videoInfo.innerHTML = `
        <h3>${anime.title.romaji}</h3>
        <p>${anime.description ? anime.description.substring(0, 150) + "..." : "No description available."}</p>
        <div style="display:flex; gap:15px; margin-top:15px; flex-wrap:wrap;">
            <div class="status-badge ${anime.status === 'ONGOING' ? 'status-ongoing' : anime.status === 'UPCOMING' ? 'status-upcoming' : 'status-finished'}">
                ${anime.status}
            </div>
            <div style="color:var(--text-secondary);">
                <i class="fas fa-play-circle"></i> ${anime.episodes || "?"} Episodes
            </div>
            <div style="color:var(--text-secondary);">
                <i class="fas fa-calendar"></i> ${anime.formattedDate}
            </div>
        </div>
    `;
    
    // Show modal
    modal.style.display = 'flex';
    document.body.style.overflow = 'hidden';
}

// Close video modal
function closeVideo() {
    const modal = document.getElementById('videoModal');
    const videoPlayerContainer = document.getElementById('videoPlayerContainer');
    
    // Stop video by removing iframe
    const iframe = videoPlayerContainer.querySelector('iframe');
    if (iframe) {
        iframe.src = ""; // Stop video playback
    }
    
    // Hide modal
    modal.style.display = 'none';
    document.body.style.overflow = 'auto';
}

// Close details modal
function closeDetails() {
    document.getElementById('detailsModal').style.display = 'none';
    document.body.style.overflow = 'auto';
}

// Update stats
function updateStats() {
    const total = animeList.length;
    const airing = animeList.filter(a => a.status === "ONGOING").length;
    const newToday = animeList.filter(a => a.hasNewEpisode).length;
    
    document.getElementById('totalAnime').textContent = total;
    document.getElementById('airingCount').textContent = airing;
    document.getElementById('newEpisodes').textContent = newToday;
}

// Notification function
function showNotification(title, body) {
    if (Notification.permission === "granted") {
        new Notification(title, { 
            body, 
            icon: "https://cdn-icons-png.flaticon.com/512/875/875680.png" 
        });
    }
}

// Enable notifications
function enableNotifications() {
    if ("Notification" in window) {
        Notification.requestPermission().then(permission => {
            if (permission === "granted") {
                showNotification("AnimeHub Notifications Enabled!", 
                    "You'll now receive alerts about new episodes and releases.");
                
                // Show confirmation message
                const btn = document.querySelector('.notification-btn');
                const originalHTML = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check"></i> Notifications Enabled!';
                btn.style.background = "linear-gradient(45deg, var(--success), #00a085)";
                
                setTimeout(() => {
                    btn.innerHTML = originalHTML;
                    btn.style.background = "linear-gradient(45deg, var(--primary), var(--primary-dark))";
                }, 3000);
            } else {
                alert("Notification permission denied. You can enable it in your browser settings.");
            }
        });
    } else {
        alert("Notifications are not supported on this browser.");
    }
}

// Auto-check for new episodes every 10 minutes
setInterval(() => {
    // In a real app, you would check for updates here
    console.log("Checking for new episodes...");
}, 600000);

// Close modals when clicking outside
window.onclick = function(event) {
    const videoModal = document.getElementById('videoModal');
    const detailsModal = document.getElementById('detailsModal');
    
    if (event.target === videoModal) {
        closeVideo();
    }
    
    if (event.target === detailsModal) {
        closeDetails();
    }
}

// Close modals with Escape key
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        closeVideo();
        closeDetails();
    }
});
</script>

</body>
</html>